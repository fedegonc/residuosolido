# Base de datos PostgreSQL (variables de entorno)
# Multipart (subida de archivos)
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB
spring.config.import=optional:file:.env[.properties]
spring.datasource.url=${DB_URL}
spring.datasource.username=${DB_USERNAME}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.driver-class-name=${DB_DRIVER:org.postgresql.Driver}

# JPA/Hibernate
spring.jpa.hibernate.ddl-auto=none
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.show-sql=false
logging.level.org.hibernate.SQL=WARN
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=WARN

# Thymeleaf sin cache
spring.thymeleaf.cache=false
logging.level.org.thymeleaf=WARN
logging.level.org.thymeleaf.templateresolver=WARN
logging.level.org.thymeleaf.TemplateEngine=WARN
logging.level.org.thymeleaf.standard=WARN
logging.level.org.springframework.web.servlet.view=WARN

# DevTools (deshabilitado temporalmente para descartar recargas que corten respuestas)
spring.devtools.restart.enabled=false
spring.devtools.livereload.enabled=false
spring.devtools.restart.additional-paths=src/main/resources/templates,src/main/resources/static
spring.devtools.restart.poll-interval=1000
spring.devtools.restart.quiet-period=400


# ☁️ Cloudinary - temporalmente deshabilitado
cloudinary.cloud_name=${CLOUDINARY_CLOUD_NAME}
cloudinary.api_key=${CLOUDINARY_API_KEY}
cloudinary.api_secret=${CLOUDINARY_API_SECRET}

# 📁 Ubicación estática base
spring.web.resources.static-locations=file:src/main/resources/static/

# HTTP tuning para evitar respuestas truncadas durante diagnóstico
server.http2.enabled=false
server.compression.enabled=false

# Timeouts más claros en MVC async (si aplica)
spring.mvc.async.request-timeout=60000

# Habilitar access log de Tomcat para correlación
server.tomcat.accesslog.enabled=false
server.tomcat.basedir=.
server.tomcat.accesslog.directory=logs
server.tomcat.accesslog.prefix=access
server.tomcat.accesslog.suffix=.log
server.tomcat.accesslog.pattern=%h %l %u %t "%r" %s %b %D reqId=%{X-Request-Id}i

# Incluir requestId del MDC en el patrón de log (si tu app usa logback)
logging.pattern.level=%5p [reqId=%X{requestId}]