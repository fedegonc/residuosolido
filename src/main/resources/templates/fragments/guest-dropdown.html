<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>

<!-- GUEST DROPDOWN COMPONENT -->
<div th:fragment="guest-dropdown">
    <!-- Barra desplegable para usuarios guest -->
    <div class="relative inline-block text-left">
        <!-- Botón principal de la barra desplegable -->
        <button id="guest-dropdown-button" 
                class="inline-flex justify-center items-center w-full px-4 py-2 text-sm font-medium text-white bg-green-600 border border-transparent rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200">
            <span>Menú</span>
            <svg id="guest-dropdown-arrow" class="w-5 h-5 ml-2 -mr-1 transition-transform duration-200" 
                 fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
            </svg>
        </button>

        <!-- Panel desplegable - Versión móvil: panel flotante, Desktop: dropdown normal -->
        <div id="guest-dropdown-panel" 
             class="fixed sm:absolute top-16 sm:top-full right-2 sm:right-0 z-50 w-56 sm:w-72 sm:mt-2 bg-white rounded-lg shadow-xl ring-1 ring-black ring-opacity-5 transform opacity-0 scale-95 transition-all duration-200 ease-out hidden overflow-y-auto max-h-[80vh]">

            
            <!-- Header del dropdown -->
            <div class="px-3 py-2 bg-gradient-to-r from-green-500 to-green-600 rounded-t-lg relative">
                <h3 class="text-base font-semibold text-white">Navegación Rápida</h3>
                <p class="text-xs text-green-100">Explora nuestro contenido</p>
                <!-- Botón cerrar para móvil -->
                <button onclick="closeGuestDropdown()" class="sm:hidden absolute top-2 right-2 text-white hover:text-green-100 transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>

            <!-- Contenido del dropdown -->
            <div class="py-1">
                <!-- Categorías principales -->
                <div class="px-3 py-1">
                    <h4 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-1">Categorías</h4>
                </div>
                
                <!-- Reciclable -->
                <a href="#reciclable" onclick="scrollToSection('reciclable')" 
                   class="group flex items-center px-2 sm:px-3 py-1 sm:py-2 text-sm text-gray-700 hover:bg-green-50 hover:text-green-800 transition-colors duration-150">
                    <div class="flex-shrink-0 w-6 h-6 sm:w-8 sm:h-8 bg-green-100 rounded-full flex items-center justify-center mr-2 sm:mr-3 group-hover:bg-green-200">
                        <svg class="w-3 h-3 sm:w-4 sm:h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                        </svg>
                    </div>
                    <div>
                        <div class="font-medium text-sm sm:text-base">Reciclable</div>
                        <div class="text-xs text-gray-500 hidden sm:block">Materiales reutilizables</div>
                    </div>
                </a>

                <!-- No Reciclable -->
                <a href="#no-reciclable" onclick="scrollToSection('no-reciclable')" 
                   class="group flex items-center px-2 sm:px-3 py-1 sm:py-2 text-sm text-gray-700 hover:bg-orange-50 hover:text-orange-800 transition-colors duration-150">
                    <div class="flex-shrink-0 w-6 h-6 sm:w-8 sm:h-8 bg-orange-100 rounded-full flex items-center justify-center mr-2 sm:mr-3 group-hover:bg-orange-200">
                        <svg class="w-3 h-3 sm:w-4 sm:h-4 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </div>
                    <div>
                        <div class="font-medium text-sm sm:text-base">No Reciclable</div>
                        <div class="text-xs text-gray-500 hidden sm:block">Residuos especiales</div>
                    </div>
                </a>

                <!-- Informaciones -->
                <a href="#informaciones" onclick="scrollToSection('informaciones')" 
                   class="group flex items-center px-2 sm:px-3 py-1 sm:py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-800 transition-colors duration-150">
                    <div class="flex-shrink-0 w-6 h-6 sm:w-8 sm:h-8 bg-blue-100 rounded-full flex items-center justify-center mr-2 sm:mr-3 group-hover:bg-blue-200">
                        <svg class="w-3 h-3 sm:w-4 sm:h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                    <div>
                        <div class="font-medium text-sm sm:text-base">Informaciones</div>
                        <div class="text-xs text-gray-500 hidden sm:block">Guías y recursos</div>
                    </div>
                </a>

                <!-- Separador -->
                <div class="border-t border-gray-100 my-1"></div>

                <!-- Acciones adicionales -->
                <div class="px-3 py-1">
                    <h4 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-1">Acciones</h4>
                </div>

                <!-- Ver todas las categorías -->
                <a href="/categories" 
                   class="group flex items-center px-2 sm:px-3 py-1 sm:py-2 text-sm text-gray-700 hover:bg-gray-50 hover:text-gray-900 transition-colors duration-150">
                    <div class="flex-shrink-0 w-6 h-6 sm:w-8 sm:h-8 bg-gray-100 rounded-full flex items-center justify-center mr-2 sm:mr-3 group-hover:bg-gray-200">
                        <svg class="w-3 h-3 sm:w-4 sm:h-4 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                        </svg>
                    </div>
                    <div>
                        <div class="font-medium text-sm sm:text-base">Ver Todas</div>
                        <div class="text-xs text-gray-500 hidden sm:block">Explorar categorías</div>
                    </div>
                </a>

                <!-- Ingresar al sistema -->
                <a href="/login" 
                   class="group flex items-center px-2 sm:px-3 py-1 sm:py-2 text-sm text-gray-700 hover:bg-green-50 hover:text-green-800 transition-colors duration-150">
                    <div class="flex-shrink-0 w-6 h-6 sm:w-8 sm:h-8 bg-green-100 rounded-full flex items-center justify-center mr-2 sm:mr-3 group-hover:bg-green-200">
                        <svg class="w-3 h-3 sm:w-4 sm:h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"></path>
                        </svg>
                    </div>
                    <div>
                        <div class="font-medium text-sm sm:text-base">Ingresar</div>
                        <div class="text-xs text-gray-500 hidden sm:block">Acceso al sistema</div>
                    </div>
                </a>
            </div>

            <!-- Footer del dropdown -->
            <div class="px-3 py-2 bg-gray-50 rounded-b-lg border-t border-gray-100">
                <p class="text-xs text-gray-500 text-center">
                    <span class="font-medium">Residuos Sólidos</span> - Frontera de la Paz
                </p>
            </div>
        </div>
    </div>

    <!-- Overlay para cerrar el dropdown -->
    <div id="guest-dropdown-overlay" class="fixed inset-0 z-40 hidden" onclick="closeGuestDropdown()"></div>
</div>

<!-- JavaScript para el componente -->
<script th:fragment="guest-dropdown-js">
    // Variables globales para el dropdown
    let guestDropdownOpen = false;

    // Función para abrir el dropdown
    function openGuestDropdown() {
        const panel = document.getElementById('guest-dropdown-panel');
        const overlay = document.getElementById('guest-dropdown-overlay');
        const arrow = document.getElementById('guest-dropdown-arrow');
        
        if (panel && overlay && arrow) {
            panel.classList.remove('hidden', 'opacity-0', 'scale-95');
            panel.classList.add('opacity-100', 'scale-100');
            overlay.classList.remove('hidden');
            arrow.classList.add('rotate-180');
            guestDropdownOpen = true;
        }
    }

    // Función para cerrar el dropdown
    function closeGuestDropdown() {
        const panel = document.getElementById('guest-dropdown-panel');
        const overlay = document.getElementById('guest-dropdown-overlay');
        const arrow = document.getElementById('guest-dropdown-arrow');
        
        if (panel && overlay && arrow) {
            panel.classList.remove('opacity-100', 'scale-100');
            panel.classList.add('opacity-0', 'scale-95');
            
            setTimeout(() => {
                panel.classList.add('hidden');
            }, 200);
            
            overlay.classList.add('hidden');
            arrow.classList.remove('rotate-180');
            guestDropdownOpen = false;
        }
    }

    // Función para alternar el dropdown
    function toggleGuestDropdown() {
        if (guestDropdownOpen) {
            closeGuestDropdown();
        } else {
            openGuestDropdown();
        }
    }

    // Función para hacer scroll a una sección específica
    function scrollToSection(sectionId) {
        const element = document.getElementById('content-' + sectionId);
        if (element) {
            element.scrollIntoView({ 
                behavior: 'smooth',
                block: 'start'
            });
            closeGuestDropdown();
        }
    }

    // Inicialización del componente
    document.addEventListener('DOMContentLoaded', function() {
        const dropdownButton = document.getElementById('guest-dropdown-button');
        
        if (dropdownButton) {
            // Evento click en el botón principal
            dropdownButton.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                toggleGuestDropdown();
            });
        }

        // Cerrar dropdown con tecla Escape
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && guestDropdownOpen) {
                closeGuestDropdown();
            }
        });

        // Prevenir que el dropdown se cierre al hacer click dentro del panel
        const panel = document.getElementById('guest-dropdown-panel');
        if (panel) {
            panel.addEventListener('click', function(e) {
                e.stopPropagation();
            });
        }

        // Cerrar dropdown al hacer click fuera
        document.addEventListener('click', function(e) {
            const dropdown = e.target.closest('#guest-dropdown-button, #guest-dropdown-panel');
            if (!dropdown && guestDropdownOpen) {
                closeGuestDropdown();
            }
        });
    });
</script>

<!-- CSS adicional para el componente -->
<style th:fragment="guest-dropdown-css">
    /* Animaciones personalizadas para el dropdown */
    #guest-dropdown-panel {
        transform-origin: top right;
    }
    
    /* Efectos hover mejorados */
    .group:hover .group-hover\:bg-green-200 {
        background-color: rgb(187 247 208);
    }
    
    .group:hover .group-hover\:bg-orange-200 {
        background-color: rgb(254 215 170);
    }
    
    .group:hover .group-hover\:bg-blue-200 {
        background-color: rgb(191 219 254);
    }
    
    .group:hover .group-hover\:bg-gray-200 {
        background-color: rgb(229 231 235);
    }
    
    /* Transiciones suaves */
    #guest-dropdown-arrow {
        transition: transform 0.2s ease-in-out;
    }
    
    /* Responsive adjustments */
    @media (max-width: 640px) {
        #guest-dropdown-panel {
            width: 90vw;
            right: 5vw;
            left: 5vw;
        }
    }
</style>

</body>
</html>
